import { LiveEditorBlock, GeneratePropsTable, CodeBlock } from '../../../utils/';
import { DocLink } from '../../../utils/pageUtils';
import { Field } from '@transferwise/components';
import { Checkbox, Alert, DateInput, Sentiment, Size } from '@transferwise/components';
import code from '../../../liveEditorCode/field.new.code';
import { getFieldValidationFailures } from '@transferwise/neptune-validation';

Field is a component that wraps an input and returns it with an attached alert message.

<LiveEditorBlock code={code} scope={{ Field, getFieldValidationFailures }} />
<GeneratePropsTable componentName="Field" />

## Validations

Field doesn't provide validation itself but it does accept an array of validation messages that will be displayed in an InlineAlert component.

Validation messages are automatically attached to the children based on user interaction and with styling.

The validation logic hasn't been integrated in Field on purpose so consumers can provide their own custom validation logic.

### Default validations

A set of default validations is provided and it should cover common scenarios. These validations are provided with standard translated error messages that can be overridden.

The default supported validations are:

** Any type **

- required
- pattern

** String type **

- minLength
- maxLength

** Number type **

- minimum
- maximum

Default validations can be access via the method

`import { getFieldValidationFailures } from '@transferwise/neptune-validation';`

getFieldValidationFailures accepts two parameters: value and rules, where value is the value to be validated and rules are the rulese to validate the value against.

An example of usage is :

```
const rules = {
  type: 'string',
  minLength: { value: 3 },
  maxLength: { value: 6, message: 'Custom maxLength error message' },
};

const failures = getFieldValidationFailures(val, rules);
```

In the example above the returned failures will be in the format:

```
[{
  message: "minLength" // A default translated message will be displayed
  value: 3
}]
```

or

```
[{
  message: "Custom maxLength error message"
  value: 5
}]
```

When requesting a validation always make sure type is provided.

```
const rules = {
  type: 'number',
  required: { value: true, message: 'Custom required' },
  minimum: { value: 3 },
  maximum: { value: 6, message: 'Custom maxLength error message' },
};


const numericValue= Number(val)

const failures = getFieldValidationFailures(val, rules);
```

<Alert
  message={
    'When validating a numeric value, the value passed to getFieldValidationFailures has to be cast to number because html number inputs returns string!'
  }
  type={Sentiment.WARNING}
/>

When a message is not provided for a specific rule, Field will populate the InlineAlert with the default message (if defined) for that specific failure.

If a custom message is provided for a specific rule it will be the one attached to the Field if that specific failures occurs.

export const meta = {
  name: `Field`,
};
